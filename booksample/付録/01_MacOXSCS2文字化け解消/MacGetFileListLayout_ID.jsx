dakuten = "%E3%82%99";handakuten = "%E3%82%9A";CR = String.fromCharCode(13);docObj = app.activeDocument;foldername = Folder.selectDialog("フォルダを指定してください");if (foldername){	fileList = foldername.getFiles();	result = "";	for (i=0; i<fileList.length; i++)	{		filename = fileList[i].name;		filename = convertKana(filename,dakuten,1);		filename = convertKana(filename,handakuten,2);		result += File.decode(filename) + CR;	}	txtObj = docObj.pages[0].textFrames.add();	txtObj.visibleBounds = ["0cm","0cm","15cm","15cm"];	txtObj.contentType = ContentType.textType;	txtObj.contents = result;}function convertKana(srcName, code, count){	srcName = srcName.replace(/%E3%82%BF%E3%82%99/g, "%E3%83%80"); // ダだけ特殊処理	var text = srcName.split(code); // 濁点	for (var i=0; i<text.length-1; i++)	{		var str = text[i];		if (str == "") continue;		var body = str.substring(0,str.length-2);		var footL = str.substring(str.length-2, str.length);		var hexL = eval("0x"+footL) + count;		hexL = hexL.toString(16).toUpperCase();		text[i] = body+hexL;	}	return text.join("");}
