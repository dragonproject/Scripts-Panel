// 自動GUI生成ツール(function(){	var CR = String.fromCharCode(13);	var tfObj = app.activeDocument.pages[0].textFrames;	// 1ページ目にレイアウトされたテキストフレームのみ対象	var text = "";	var posLeft = 100;	// ウィンドウの左座標	var posTop = 300;	// ウィンドウの上座標	var posRight = 0;	// 右限	var posBottom = 0;	// 下限	for (var i=0; i<tfObj.length; i++){		var rect = tfObj[i].geometricBounds;		var t = parseInt(rect[0]);	// 上		var l = parseInt(rect[1]);	// 右		var b = parseInt(rect[2]);	// 下		var r = parseInt(rect[3]);	// 左		var content = tfObj[i].contents;		var xType = (content.split("/")[0]).toLowerCase();		var xCont = content.split("/")[1];		var rectStr = l+","+t+","+r+","+b;		if (r > posRight) { posRight = r; }	// 最大の右幅をチェックしておく		if (b > posBottom) { posBottom = b; }	// 最大の下幅をチェックしておく		switch(xType){			case "ok" : 				text = text + "dlg['ok'] = dlg.add('button', ["+rectStr+"],'"+xCont+"', {name:'ok'});";				break;			case "cancel" :				text = text + "dlg['cancel'] = dlg.add('button', ["+rectStr+"],'"+xCont+"', {name:'cancel'});";				break;			default :				text = text + "dlg['item"+i+"'] = dlg.add('"+xType+"', ["+rectStr+"],'"+xCont+"');";		}		text = text + CR;	}	posRight = posLeft + posRight + 20;	// ウィンドウのサイズ（右）	posBottom = posTop + posBottom + 20;	// ウィンドウのサイズ（下）	text = "var dlg = new Window('dialog', 'Sample', ["+posLeft+","+posTop+","+posRight+","+posBottom+"]);" + CR + text + CR;	text = text + "dlg.show();"+CR;	var tfObj2 = app.documents.add().pages[0].textFrames.add();	tfObj2.geometricBounds = ["2cm","20cm","20cm","2cm"];	tfObj2.contents = text;	eval(text);	// サンプルを実行したくない場合は、ここをコメントアウトしてください})();
